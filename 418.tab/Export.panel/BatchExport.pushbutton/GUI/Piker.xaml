<Window xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Piker"
        Height="520" Width="840"
        WindowStartupLocation="CenterOwner">
  <Grid Margin="12">
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="*"/>
      <RowDefinition Height="Auto"/>
    </Grid.RowDefinitions>

    <TextBlock Text="Configuration du nommage" FontSize="16" FontWeight="Bold"/>

    <!-- zoneCentrale: gauche = filtres + paramètres; centre = boutons; droite = DataGrid des paramètres choisis -->
    <Grid Grid.Row="1" Margin="0,8,0,8">
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="280"/>
        <ColumnDefinition Width="80"/>
        <ColumnDefinition Width="*"/>
      </Grid.ColumnDefinitions>

      <!-- leftSection: filtres + liste des paramètres -->
      <Border Grid.Column="0" BorderBrush="#CCC" BorderThickness="1" CornerRadius="4" Padding="8" Margin="0,0,8,0">
        <StackPanel>
          <!-- scopeFilter -->
          <TextBlock Text="Source des paramètres" FontWeight="Bold"/>
          <ComboBox Name="ScopeCombo" Margin="0,4,0,8">
            <ComboBoxItem Content="Tout" IsSelected="True"/>
            <ComboBoxItem Content="Projet"/>
            <ComboBoxItem Content="Collection"/>
            <ComboBoxItem Content="Feuille"/>
          </ComboBox>
          <!-- availableParams -->
          <TextBlock Text="Paramètres disponibles" FontWeight="Bold" Margin="0,2,0,4"/>
          <ListBox Name="AvailableParamsList" Height="300"/>
        </StackPanel>
      </Border>

      <!-- middleButtons: actions ajouter / retirer -->
      <StackPanel Grid.Column="1" VerticalAlignment="Center" HorizontalAlignment="Center">
        <Button Name="AddParamButton" Content="Ajouter →" Width="74" Height="28" Margin="0,0,0,8"/>
        <Button Name="RemoveParamButton" Content="← Supprimer" Width="74" Height="28"/>
      </StackPanel>

      <!-- rightGrid: paramètres choisis avec prefix/suffix par ligne -->
      <Border Grid.Column="2" BorderBrush="#CCC" BorderThickness="1" CornerRadius="4" Padding="8">
        <StackPanel>
          <TextBlock Text="Paramètres choisis" FontWeight="Bold" Margin="0,0,0,6"/>
          <DataGrid Name="SelectedParamsGrid" AutoGenerateColumns="False" CanUserAddRows="False" HeadersVisibility="Column" Height="320">
            <DataGrid.Columns>
              <!-- colParamName -->
              <DataGridTextColumn Header="Paramètre" Binding="{Binding [Name]}" Width="2*"/>
              <!-- colPrefix editable -->
              <DataGridTemplateColumn Header="Préfix" Width="*">
                <DataGridTemplateColumn.CellTemplate>
                  <DataTemplate>
                    <TextBox Text="{Binding [Prefix], Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                             LostFocus="ParamCell_LostFocus"
                             TextChanged="ParamCell_TextChanged"/>
                  </DataTemplate>
                </DataGridTemplateColumn.CellTemplate>
              </DataGridTemplateColumn>
              <!-- colSuffix editable -->
              <DataGridTemplateColumn Header="Suffix" Width="*">
                <DataGridTemplateColumn.CellTemplate>
                  <DataTemplate>
                    <TextBox Text="{Binding [Suffix], Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                             LostFocus="ParamCell_LostFocus"
                             TextChanged="ParamCell_TextChanged"/>
                  </DataTemplate>
                </DataGridTemplateColumn.CellTemplate>
              </DataGridTemplateColumn>
            </DataGrid.Columns>
          </DataGrid>
        </StackPanel>
      </Border>
    </Grid>

    <!-- Aperçu du pattern résultant -->
    <Border Grid.Row="2" BorderBrush="#DDD" BorderThickness="1" CornerRadius="4" Padding="8" Margin="0,0,0,8">
      <StackPanel Orientation="Vertical">
        <TextBlock Text="Aperçu" FontWeight="Bold"/>
        <TextBlock Text="Chaque ligne génère: Préfix + {Paramètre} + Suffix. L'ensemble est concaténé." FontSize="11" Foreground="#666"/>
        <TextBlock Name="PatternPreviewText" Text="" Margin="0,4,0,0" Foreground="#333" FontFamily="Consolas"/>
        <DockPanel Margin="0,8,0,0" LastChildFill="False">
          <Button Name="CancelButton" Content="Annuler" Width="110" Height="30" Margin="0,0,8,0" />
          <Button Name="OkButton" Content="OK" Width="110" Height="30" />
        </DockPanel>
      </StackPanel>
    </Border>
  </Grid>
</Window>
